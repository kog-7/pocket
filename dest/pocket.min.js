!function(t){if(t){var e=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e=typeof t;return"string"===e||"number"===e||"function"===e?e:(e=Object.prototype.toString.call(t),e.indexOf("rray")!==-1||e.indexOf("rguments")!==-1?"array":e.indexOf("ragment")!==-1?"fragment":e.indexOf("odeList")!==-1?"nodelist":e.indexOf("lement")!==-1?"node":e.indexOf("egExp")!==-1?"regexp":e.indexOf("bject")!==-1&&"object")},n=function(t){var e=!0;for(var n in t)e=!1;return e},r=function(t,e){var n=null;for(n in e)n in t||(t[n]=e[n]);return t},a=function(t,e){var n=null;for(n in e)t[n]=e[n];return t},i=function(t,e){var n=function(){},r=null;return n.prototype=t,r=new n,e&&a(r,e),r},o=function(t,e,r,a){if(".NUMBER"===t)return r;if(["number","string"].indexOf(typeof e)!==-1)return e;var i=t.split("."),o=i.length,u="",l=0;if("JRootScope"===i[0]){i.shift(),o=i.length;for(var s;e&&!n(e)&&(s=Object.getPrototypeOf(e),!n(s));)e=s}for(var c=e,f=null;c&&!n(c);){for(l=0,e=c;l<o;l+=1){if(u=i[l],!e.hasOwnProperty(u)){e=null;break}if(e=e[u],void 0===e)break}if(e){f=e;break}c=Object.getPrototypeOf(c)}return f=!!f&&f},u=function(t){var e=t.toString(),n=e.indexOf("("),r=e.indexOf(")");return e=e.slice(n+1,r),e.split(",")},l=function(t,e){var n=null;for(n in t)e(n,t[n])},s=function(t){for(var e=t.split(" "),n=e.length,r=n-1;r>=0;r-=1)e[r]||e.splice(r,1);return e},c=function(t,e){var n=t.childNodes,r=0,a=n.length,i=null;if(0===a)return void 0===e?t.innerHTML:(t.innerHTML=e,e);for(;r<a;r+=1)if(i=n[r],3===i.nodeType)return void 0===e?i.nodeValue:(i.nodeValue=e,e);return""},f="pocket_record_id",p=function(t){return new RegExp("\\"+t+"([\\w\\.\\-\\:\\|\\,\\#\\s\\&\\u4e00-\\u9fa5]+)\\"+t,"gm")},h=function(t){this.message=t,this.name="UserException"},d={},v=function(t,e){"string"==typeof t&&(this.aim=t),"string"==typeof e&&(this.url=e),this._init()},m={constructor:v,sn:{id:0}},y={_init:function(){this.id=this.sn.id+=1}};r(m,y);var g=function(){var t=function(t){var e=t.lastIndexOf("/");if(e===-1)return{dirname:"",basename:t};var n=t.slice(0,e+1),r=t.slice(e+1);return{dirname:n,basename:r}},e=function(t,e){var n,r=e.split("/"),a=r.length,i=0,o=null,u="",l=t.indexOf("?"),s=t.indexOf("#");l=l===-1?Number.POSITIVE_INFINITY:l,s=s===-1?Number.POSITIVE_INFINITY:s,n=Math.min(l,s),n!==-1&&(u=t.slice(n),t=t.slice(0,n));for(var c=t.split("/");i<a;i+=1)o=r[i],".."===o?c.pop():o&&"."!==o&&c.push(o);return c=c.join("/")+u};return{join:e,split:t}}(),b=function(t,e,n){var r;t.lastIndex=0;for(var a=[],i=0,o=0,u="";r=t.exec(e);)i=1,a.push({type:!0,html:e.slice(o,r.index)}),u=r[1],u=u.replace(/\s+/g,function(){return""}),a.push({type:!1,url:u,jsFilter:r[3]}),o=t.lastIndex;return 0!==i&&(a.push({type:!0,html:e.slice(o)}),t.lastIndex=0,a)},x=function(t){var e,n,r=/^[\n\s\r]+/,a=/[\n\s\r]+$/,i=r.exec(t),o=a.exec(t);return i||o?(i&&(e=i[0].length),o&&(n=o[0].length),e&&(t=t.slice(e)),n&&(t=t.slice(0,-n)),t):t},_=function(t){var e,n=t.html,r=t.url,a=t.callback,i=t.jsonp,o=/\'?\@include\(([\w\.\-\/\s]+)((\|[\w\-]+(\:[\w\-]+)*)*)\)[\;]*\'?/g;e=n?{type:!1,html:n}:{type:!1,url:r,baseUrl:""};var u=[e],l=[],s=function(t,e,n){function r(){for(var r="",i=0,o=t.length;i<o;i+=1){if(t[i].type===!1)return;r+=t[i].html}e.type=!0,e.html=r,void 0===n?a(e):n()}var u=e.baseUrl,c=0,f="",p=null;t.forEach(function(t,e){if(t.type===!1)if(p=t.url=g.join(u,t.url),t.baseUrl=g.split(p).dirname,p){if(l.indexOf(p)!==-1)return console.warn("模版循环引用"),t.html="",void(t.type=!0);if(p in d){var n=d[p],h=b(o,n);h?(l.push(p),s(h,t,r)):(t.type=!0,t.html=n,r())}else{var v={url:p};i===!0&&(v.dataType="jsonp"),$.ajax(v).done(function(e){e=x(e);var n=b(o,e);n?(l.push(p),s(n,t,r)):(t.type=!0,t.html=e,r(t.jsFilter))}).fail(function(){console.log("read "+p+" wrong"),a({html:""})})}c=1}else h=b(o,t.html),h?(s(h,e,r),c=1):(t.type=!0,f+=t.html);else f+=t.html}),0===c&&("object"==typeof e&&(e.type=!0,e.html=f),void 0===n?a(e):n())};s(u,e)},w=function(){this.storeExp={},this.storeExpItem=0,this.signItem=0,this.signStore={},this.refOb={}},k={constructor:w,sn:{id:0}},E={upper:function(t){return t.toUpperCase()},lower:function(t){return t.toLowerCase()},length:function(t){return"array"!==e(t)?t:t.length},safe:function(t){if("string"==typeof t)return safeHtml(t)},toString:function(t){return t.toString()}},I={filters:E};v.setFilter=function(t){a(E,t)},r(k,I);var j={match:"?",regMatch:function(){var t=this.match;return p(t)},getMatchValue:function(t,e,n,r){var a,i=this,u=t.variable,l=t.filter,s=[],c=null,f=i.filters,p=u.indexOf(",");u=p!==-1?u.split(","):[u];var h,d;return u.forEach(function(t,a){d="",h=t.indexOf(":"),h!==-1&&(d=t.slice(h+1),t=t.slice(h));var i=o(t,e,n,r);i===!1&&(i=d),s.push(i)}),p===-1&&(s=s[0]),l?(a=s,l.forEach(function(t){c=f[t],"function"==typeof c&&(a=c.apply(null,[a,n,r]))}),a||0===a||(a="")):a=s,a}};r(k,j);var O=function(t,e,n){var r=null;switch(t!==!0&&"true"!==t||(t="true"),t!==!1&&"false"!==t||(t="false"),n!==!0&&"true"!==n||(n="true"),n!==!1&&"false"!==n||(n="false"),"=="!==e&&"="!==e||(e="="),"!="!==e&&"!=="!==e||(e="!"),isNaN(+t)||(t=+t),isNaN(+n)||(n=+n),e){case"<":r=t<n;break;case">":r=t>n;break;case">=":r=t>=n;break;case"<=":r=t<=n;break;case"=":r=t===n;break;case"!":r=t!==n}return r},S=function(t){var e,n,r="|",a=t.indexOf(r),i=null,o=!1;a!==-1?(e=t.slice(0,a),n=t.slice(a+1),n&&"&"===n.substr(-1,1)&&(o=!0,n=n.slice(0,-1)),n&&(i=n.split(","))):("&"===t.substr(-1,1)&&(o=!0,t=t.slice(0,-1)),e=t);var u;return u=e.split(",")[0].split(":")[0],{filter:i,variable:e,firstAttr:u,save:o}},F=function(t,e){var n=t.indexOf(" "),r=t;n!==-1&&(r=t.slice(0,n));var a,i=null,o=null;return"for"===r?(o=new RegExp("for\\s+([\\w|\\|\\-]+)\\s+in\\s+(\\"+e+'?[\\{\\}\\w|\\|\\.\\[\\]\\,\\"\\:]+\\'+e+"?)\\s*"),a=o.exec(t),i=[a[1],a[2]],i.type="for"):"if"===r?(o=new RegExp("if\\s+(\\"+e+"?[\\w|\\|\\.\\-]+\\"+e+"?)\\s+([\\<\\>\\=\\!]+[\\<\\>\\=\\!]*)\\s+(\\"+e+"?[\\w\\|\\.\\-]+\\"+e+"?)"),a=o.exec(t),i=[a[1],a[2],a[3]],i.type="if"):"template"===r?(o=/template\s*([\w\-]*)/,a=o.exec(t),i=[a[1]],i.type="template"):"scope"===r&&(o=new RegExp("scope\\s+([\\w|\\|\\-]+)\\s+as\\s+(\\"+e+'?[\\{\\}\\w|\\|\\.\\[\\]\\,\\"\\:]+\\'+e+"?)\\s*"),a=o.exec(t),i=[a[1],a[2]],i.type="scope"),i},T={handExpress:function(t,e,n,r){var a=this,i=S(t),o=a.match;n||(n=0),r||(r=1);var u,l=i.filter,s=i.variable,c=a.storeExp,f=a.refOb;if(!l||"EXPRESS"!==l[0]){if(s.indexOf("REF")!==-1){ref=s.slice(3),ref=ref?ref:"OTHER";var p="";return ref in f||(p=a.sn.id+=1,f[ref]=ref+"-"+p),'data-xjref="'+ref+'"'}u=a.getMatchValue(i,e,n,r);var h={value:u,attr:i.firstAttr,save:i.save};return h[a.keySign]=!0,h}var d=c[s],v=F(d.express,o);if("for"===v.type){var m=v[1],y=v[0];if(m[0]===o){m=m.slice(1,-1);var g=S(m);u=a.getMatchValue(g,e,n,r),u||(u="")}else try{u=JSON.parse(m)}catch(t){u=""}return"object"!=typeof u?"":{data:u,template:d.html,prefix:y,lastData:e}}if("if"===v.type){var b=v[0],x=v[2],_=a.regMatch().exec(b),w=a.regMatch().exec(x);_&&(b=_[1],b=a.getMatchValue(S(b),e,n,r)),w&&(x=w[1],x=a.getMatchValue(S(x),e,n,r));var k=O(b,v[1],x);return k?{data:e,template:d.html}:""}if("template"===v.type){var E=v[0];return E="init"===E,{init:E,type:"template",data:e,template:d.html}}if("scope"===v.type){var I=v[1],j=v[0];if(I[0]===o){I=I.slice(1,-1);var T=S(I);u=a.getMatchValue(T,e,n,r),u||(u="")}else try{u=JSON.parse(I)}catch(t){u=""}var M={};return M[j]=u,{data:M,template:d.html,lastData:e}}}};r(k,T);var M=function(t,e){if("string"==typeof t){var n,r=new RegExp("\\{\\{(\\w+)\\s*(\\"+e+'|\\{\\"|\\}|[\\:\\"\\,\\w\\s\\>\\<\\=\\|\\.\\!\\[\\]])*\\}\\}'),a=null,i=0,o="",u="",l=null,s="",c=[],f=[];l=r.exec(t),r.lastIndex=0;var p="";do{if(0===i){if(!l)return!1;l=l[1],n=new RegExp("\\{\\{"+l+"\\s*(\\"+e+'|\\{\\"|\\}|[\\:\\[\\]\\,\\"\\w\\s\\>\\<\\!\\=\\|\\.])*\\}\\}|(\\{\\{\\/'+l+"s*\\}\\})","g"),a=n.exec(t),o=[a.index,n.lastIndex]}else a=n.exec(t);a[2]?i-=1:i+=1,0===i&&(u=[a.index,n.lastIndex],p=t.slice(0,o[0]),f=[{html:p},{html:t.slice(o[1],u[0]),express:t.slice(o[0]+2,o[1]-2)}],t=s=t.slice(u[1]),l=r.exec(s),r.lastIndex=0,c=c.concat(f))}while(a&&l);return c.push({html:s}),c}},D={keySign:function(){var t=(100*Math.random()).toFixed(0);return"pocket_var"+t}(),_toSignString:function(t,e,n){if(n!==!0)return e;var r=this,a=r.keySign,i=r.signItem+=1;return i=i.toString(),r.signStore[i]={attr:t,value:e},"#"+a+i+a+"#"},stringEachArr:function(t,e,n,r){for(var a,i=this,o=i.regMatch(),u=null,l="",s="",c=0,f=0,p="",h="";u=o.exec(t);)l=u[1],c=u.index,h=t.slice(f,c),s+=h,p+=h,a=i.handleStr(l,e,n,r),"object"!=typeof a?(s+=a,p+=a):"copyHtml"in a?(s+=a.html,p+=a.copyHtml):(s+=a.value,p+=i._toSignString(a.attr,a.value,a.save)),f=o.lastIndex;return h=t.slice(f),s+=h,p+=h,{html:s,copyHtml:p}},handleStr:function(t,e,n,r){var a=this,i=a.handExpress(t,e,n,r),o=a.keySign;return["number","string"].indexOf(typeof i)!==-1?i:i[o]===!0?i:a.render(i,"middle")},_changeToTemplate:function(t){var e=this.keySign;return'<script class="'+e+'" type="text/html">'+t+"</script>"},render:function(t,n){var r,a=t.template,o=t.data,u=t.prefix,l=this,s=this.match,c=M(a,s),f=t.callback,p=t.lastData,h=t.type,d=t.init,v="",m=null,y=null,g="",b="";if("template"===h&&(g=b=l._changeToTemplate(a),d!==!0))return{html:g,copyHtml:b};if("array"===e(c))for(var x=0,_=c.length,y=null,w="";x<_;x+=1)y=c[x],y.express?(r=l.storeExpItem+=1,w="XJ"+r,l.storeExp[w]=y,v+=s+w+"|EXPRESS"+s):v+=y.html;else c===!1&&(v=a);var k=null,E=e(o);y=null;var _,x=0;if("array"===E&&null===n)for(x=0,_=o.length;x<_;x+=1)y=o[x],"object"==typeof y&&(y.NUMBER=x.toString()),m=y,p&&(m=i(p,m)),k=l.stringEachArr(v,m,x,_),g+=k.html,b+=k.copyHtml;else if("array"===E&&u)for(x=0,_=o.length;x<_;x+=1)y=o[x],"object"==typeof y&&(y.NUMBER=x.toString()),m={},m[u]=y,p&&(m=i(p,m)),k=l.stringEachArr(v,m,x,_),g+=k.html,b+=k.copyHtml;else if("object"===E&&u){var I="";for(I in o)y=o[I],y={value:y,attr:I},m={},m[u]=y,p&&(m=i(p,m)),k=l.stringEachArr(v,m),g+=k.html,b+=k.copyHtml}else p&&(o=i(p,o)),k=l.stringEachArr(v,o,0,1),g+=k.html,b+=k.copyHtml;var j={html:g,copyHtml:b};return n||"function"==typeof f&&f(j,l.refOb,l.signStore,l.keySign),j}};r(k,D),w.prototype=k;var N=function(){var t=function(){this._runFuns=[],this._args=[],this.break=!0},e=function(t){var e=this._runFuns;return e.push(t),this},n=function(t){return"function"==typeof t&&void(this._endFun=t)},r=function(t){return"number"==typeof t&&void(this.length=t)},a=function(t,e,n){n||(n=0);var r,a,i=e+n-1;return t>i?(a=t-i,r=a%e,t=0===r?i:n-1+r):t<n&&(a=n-t,r=a%e,t=0===r?0:i+1-r),t},o=function(t){var e=t.item,n=t.arg,r=t.insert,a=this._args,i=this._runFuns,o=this.length;if(o||(o=i.length),"number"==typeof e)a[e]||(a[e]=[]),"append"===r?a[e]=a[e].concat(n):a[e]=n;else for(var u=0;u<o;u+=1){var l=a[u];l||(a[u]=[]),"append"===r?a[u]=a[u].concat(n):a[u]=n}},u=function(){var i=function(t){var e=this._runFuns,n=this.length;n||(n=e.length);var r=0,a=function(){};a.prototype=this;var i=new a;return i.focus=r,i.collectData=[],i.break=!1,i.length=n,i._args=[].concat(i._args),setTimeout(function(){var t=i._args,n=i.focus,r=e[n],a=t[n];i.focus+=1,r.call(i,{setup:a})},0),i},l=function(){var t=this._endFun;if(this.break===!0)return void(t&&t(this.collectData));var e=Array.prototype.slice.call(arguments,0),n=this._args,r=this.length,i=this.focus,o=this._runFuns,u=o.length,l=a(i,u),s=n[i],c={setup:s,flow:e},f=this.collectData;f.push(c),this.focus+=1,i>=r?(this.focus=0,t&&t.call(null,f)):o[l].call(this,c)};return u=function(){this._runFuns=[],this._args=[]},u.prototype={constructor:u,clear:t,get:e,setArg:o,setCallback:n,go:i,setLength:r,next:l},u}(),l=function(){var i=function(t){var e=this._runFuns,n=this.length;n||(n=e.length);var r=0,i=function(){};i.prototype=this;var o=new i;return o.focus=r,o.collectData=[],o.break=!1,o.length=n,o._args=[].concat(o._args),setTimeout(function(){for(var t,e=o._args,n=(o.focus,o._runFuns),r=o.length,i=n.length,u=0,l=null,s=null;u<r;u+=1)t=a(u,i),l=n[t],s=e[u],l.call(o,{setup:s})},0),o},u=function(){var t=this._endFun;if(this.break===!0)return void(t&&t(this.collectData));var e=Array.prototype.slice.call(arguments,0),n=this.length,r=this.focus,a=this.collectData;a.push(e),this.focus+=1,r>=n-1&&(this.focus=0,t&&t.call(null,a))};return l=function(){this._runFuns=[],this._args=[]},l.prototype={constructor:l,clear:t,get:e,setArg:o,setCallback:n,go:i,setLength:r,next:u},l}(),s=function(t,e,n){this.updateCallbacks=e,this.updateInfos=n,this.factory=t,this.binds={}},c=function(t,e,n){var r=this,a=r.binds,i=a[t],o=r.factory;i||(i=a[t]=[]);var u={point:e,envir:o};return n&&(u.envir=n),i.push(u),r},p=function(t){var e=this,n=e.binds;t in n&&delete n[t]},d=function(){var t=this,e=i(t);e.runType="sync";var n=e.syncFun=new u;return e.step=-1,setTimeout(function(){n.go()},0),e},v=function(t){var e=this,n=i(e);n.runType="collect";var r=n.collectFun=new l;return n.step=-1,setTimeout(function(){r.go()},0),"function"==typeof t&&r.setCallback(t),n},m=function(t,e){var n=this,r=n.runType;return r?n["_"+r+"Update"](t,e):n._update(t,e),n},y=function(t,e){var n=this,r=n.updateCallbacks,n=this,a=n.keyword,i=n.refId,o=n.updateInfos;if(r){var u=r[t],l=$("[data-"+a+"="+i+"]");"function"==typeof u&&u.call(n.factory,{current:l,message:o,value:e},n._cbCallback(l,t))}},g=function(t,e){if("function"!=typeof e)throw new h("异步队列下updateState第二个参数必须为函数");var n=this,r=n.syncFun,a=n.step+=1;r.setArg({item:a,arg:[t]}),r.get(n._cbFun(e))},b=function(t,e){if("function"!=typeof e)throw new h("异步队列下updateState第二个参数必须为函数");var n=this,r=n.collectFun,a=n.step+=1;r.setArg({item:a,arg:[t]}),r.get(n._cbFun(e))},x=function(t,e){var n=this,r=n.binds,a=n.keyword,i=r[e];return function(e){i&&setTimeout(function(){i.forEach(function(r,i){var o=r.envir,u=r.point.split("."),l=u[0],s=u[1],c=o[l],f=c.updateCallbacks,p=c.updateInfos,h=f[s],d=c.refId,v=$("[data-"+a+"="+d+"]");"function"==typeof h&&h.call(o,{trigger:t,current:v,message:p,value:e},n._cbCallback(v))})},16.666)}},_=function(t){return function(e){t.next(e)}},w=function(t,e,n,r){return function(a){n.value=a,t.call(e,n,r)}},k=function(t){var e=this,n=e.updateCallbacks,r=e.keyword,a=e.refId,i=e.updateInfos,o=$("[data-"+r+"="+a+"]"),u=e.factory;return function(r){var a,l=r.setup,s=r.flow;s&&(a=s[0]);var c,f=l[0];n&&(c=n[f]),c||(c=function(){});var p=e._cbCallback(o,f),h=this;t(e._cbFun2(h),e._cbFun3(c,u,{current:o,message:i},p),a,i)}};return s.prototype={keyword:f,bind:c,unbind:p,sync:d,collect:v,updateState:m,_update:y,_syncUpdate:g,_collectUpdate:b,_cbCallback:x,_cbFun2:_,_cbFun3:w,_cbFun:k},s}(),A=function(){var t=function(){};return t.prototype={init:function(t,e,n,r){var a=this;a.loaded=!1,a.attrs=e,a._decoration(n,t,r)},_decoration:function(t,e,n){var r=this;l(t,function(t,a){var i=n[t],o=e[t],u=new N(r,i,o);u.ref=t,u.refId=a,r[t]=u})}},t}(),C={setTemplate:function(t,e){"string"==typeof t&&(this.url=t),"jsonp"===e&&(this.jsonp=!0)},setHtml:function(t){"string"==typeof t&&(this.template=t)},setContainer:function(t){"string"==typeof t&&(this.aim=t)},setCallback:function(t){var e=this;"function"==typeof t&&(e.mountCallback=t)},_sendData:function(t){var e=this;return function(n){"object"==typeof t&&n?t.data=n:t={data:n},e.render(t,e)}},useData:function(t){var e=this;if("function"!=typeof t)return e;var n=i(e);return n._cbData=!0,setTimeout(function(){var e=n.lazyData;n._cbData=!1,t(n._sendData(e)),delete n.lazyData,delete n._cbData},0),n},render:function(t,e){var n=this;if(n._cbData===!0)return n.lazyData=t,n;var r,a,o,u,l,s,c;t&&(r=t.aim,a=t.attrs,o=t.data,u=t.template,l=t.url,s=t.insert,c=t.jsonp),u=u?u:n.template,l=l?l:n.url,r=r?r:n.aim,e&&"render"in e||(e=i(n)),e.aim=r,void 0===c&&(c=n.jsonp),void 0!==a&&(e.attrs=a),l&&l in d&&(u=d[l]);var f={template:u,data:o,callback:function(t,n,r,a){e._handleDom(t,s,n,r,a)}},p=new w;setTimeout(function(){u?p.render(f):_({url:l,callback:function(t){var e=d[l]=t.html;f.template=e,p.render(f)},jsonp:c})},0);var h=new A;e.updateOb=h}};r(m,C);var R=function(t,e,n){var r=null,a=null,i=null;if(!t)return!1;for(r in t)r in e&&(a=t[r],i=u(a),i.forEach(function(t,n){0===n?i[n]=e[r]:t in e?i[n]=e[t]:i[n]=null}),a.apply(n,i))},H=function(t,e,n,r,a,i){var o=t[n];n in t&&"object"==typeof t[n]||(o=t[n]=[]);var u=e.attr,l=e.value;u=u?u:"__default";var s={};s.type="textContent",s.value=l,s.attr=u,void 0!==i&&(s.domItem=i),o.push(s)},U=function(t,e,n,r,a,i,o){var u=t[n];n in t&&"object"==typeof t[n]||(u=t[n]=[]);var l=e.attr,s=e.value;l=l?l:"__default";var c={};c.value=s,c.type="class",c.classItem=r,c.attr=l,void 0!==o&&(c.domItem=o),u.push(c)},P=function(t,e,n,r,a,i,o){var u=t[n];n in t&&"object"==typeof t[n]||(u=t[n]=[]);var l=e.attr,s=e.value;l=l?l:"__default";var c={};c.value=s,c.type="style",c.style=r,c.attr=l,void 0!==o&&(c.domItem=o),u.push(c)},V=function(t,e,n,r,a,i){var o=t[n];n in t&&"object"==typeof t[n]||(o=t[n]=[]);var u=e.attr,l=e.value;u=u?u:"__default";var s={};s.value=l,s.type="formValue",s.attr=u,void 0!==i&&(s.domItem=i),o.push(s)},L=function(t,e,n,r,a,i){var o=t[n];n in t&&"object"==typeof t[n]||(o=t[n]=[]);var u=e.attr,l=e.value;u=u?u:"__default";var s={};s.value=l,s.type="pocketData",s.attr=u,void 0!==i&&(s.domItem=i),o.push(s)},J=function(t,e,n,r,a,i,o){var u=new RegExp("\\#"+a+"(\\d+)"+a+"\\#","gm"),l=c(n[0]);if(l.trim())for(var f,p,h;f=u.exec(l);)p=f[1],h=r[p],H(t,h,e,i,p,o);var d=n[0].tagName;if(["INPUT","TEXTAREA"].indexOf(d)!==-1){var v;for(v="INPUT"===d?n.val():n.text();f=u.exec(v);)p=f[1],h=r[p],V(t,h,e,i,p,o)}for(var m=n.attr("pocket-data");f=u.exec(m);)p=f[1],h=r[p],L(t,h,e,i,p,o);var y=n.attr("class");y&&(y=s(y),y.forEach(function(n,a){for(u.lastIndex=0;f=u.exec(n);)p=f[1],h=r[p],U(t,h,e,a,i,p,o)}));var g=$("<div></div>");g.append(n.clone(!0));var b=/^\<[^\<\>]+style=[\'\"]?([\(\)\;\s\-\w\:\[\]\#]+)[\'\"]?[^\<\>]+\>/g.exec(g.html());b&&(b=b[1],b=b.split(";"),b.forEach(function(n,a){n=n.split(":");var l=n[0],s=n[1];for(u.lastIndex=0;f=u.exec(s);)p=f[1],h=r[p],P(t,h,e,l,i,p,o)}))},X=function(t,e,n,r,a,i){n.length>1?n.each(function(n,o){o=$(o),J(t,e,o,r,a,i,n)}):J(t,e,n,r,a,i)},z={keyword:f,_handleDom:function(t,e,n,r,a){var i=t.html,o=t.copyHtml,u=this,l=$(i),s=$("<div></div>");s.append(l);var c=$(o),f=null,p=null,h=null,d=u._beforeMount,v=u._afterMount,m=u.attrs,y=u.updateOb,g=u.keyword,b={},x=u.aim,_=$("<div></div>");_.append(c);var w={};for(p in n)n.hasOwnProperty(p)&&(h=n[p],f=s.find("[data-xjref="+p+"]"),copyNd=_.find("[data-xjref="+p+"]"),f[0].hasAttribute("pocket-data")&&f.removeAttr("pocket-data"),b[p]=f,f.removeAttr("data-xjref"),f[0].setAttribute("data-"+g,h),X(w,p,copyNd,r,a,h));y.init(w,m,n,u._update),"string"==typeof x&&(x=$(x)),"function"==typeof u.mountCallback&&u.mountCallback.call(y),d&&R(d,b,y),"append"===e?x.append(l):"prepend"===e?x.prepend(l):x.html("").append(l),v&&R(v,b,y),y.loaded=!0,delete u.updateOb}};r(m,z);var B={beforeMount:function(t){"object"===e(t)&&(this._beforeMount?a(this._beforeMount,t):this._beforeMount=t)},afterMount:function(t){"object"===e(t)&&(this._afterMount?a(this._afterMount,t):this._afterMount=t)},update:function(t){"object"===e(t)&&(this._update?a(this._update,t):this._update=t)}};r(m,B),v.prototype=m,"function"==typeof define&&define.amd&&define("pocket",[],function(){return v}),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=v),t.Pocket=v}}("undefined"!=typeof window?window:null);